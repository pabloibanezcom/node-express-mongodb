# NODE-EXPRESS-MONGODB.API

This project allows you to create a powerful REST API in a very short time. It relies on 

[NodeJS](https://nodejs.org/en/) | [Express](https://expressjs.com/)
| [MongoDB](https://www.mongodb.com/) | [Mongoose](http://mongoosejs.com/) | [PassportJS](http://www.passportjs.org/)

This is not a NPM package. It is a skeleton app so we need to clone it.

## Table of Contents

* [Setting up](#setting-up)
* [Usage](#usage)
* [Authentication](#authentication)
* [Data generation](#data-generation)
* [Postman project generation](#postman-project-generation)

## Setting up

First of all we need to set up the environment variables by creating .env file in root.

Key  | Description 
---       | ---
APP_NAME | Name of the application 
HOST | Host url. *Only for Postman purposes (optional)*
PORT | Port number. *Only for Postman purposes (optional)*
MONGODB_URI | MongoDB database URI
FB_APP_KEY | Facebook app key for authentication *(optional)*
FB_APP_SECRET | Facebook secret key for authentication *(optional)*

## Usage

The way it generates the API is by reading each of the model definitions at `./app/models`. We need to create (and likely delete the existing examples) one definition for each of the models in our app.

Once the app is started it generates all the routes based on them.

### Default routes

There are 5 default routes. These are created if they are activated in the model.

Route  | Description 
---       | ---
GET api/[modelRoute] | Returns all the documents
GET api/[modelRoute]/:id | Returns one document
POST api/[modelRoute] | Creates one document
PUT api/[modelRoute]/:id | Updates one document
DELETE api/[modelRoute]/:id | Remove one document 

### Custom routes

It is possible to create custom routes. For this you have to add a route file to `./app/routes` and the service to use to `./app/services`. Both files must be named as the route in  modeldefinition.

## Authentication

It is possible to add authentication to the routes by PassportJS. The way to do this is by defining the `passportStrategy`in the method object:

`"methods": {"get": { "enabled": true, "passportStrategy": "admin" }}`

**[!]** Note that in this case admin strategy would need to be defined in passport.js

## Data generation

It is possible to auto generate data in the DB for dev purposes by just adding a collection to a json file named as the model in `./generation/data`.

In order to run this task an extra endpoint is set up. ***/api/admin/generate***.

## Postman project generation

A Postman configuration object is generated by default so it can be easily imporated in Postman to get the collection of all endpoints in the app.

All you have to do in Postman is

*Import > Import From Link* and copying the follow app endpoint:

***/api/postman***

